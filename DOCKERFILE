FROM mcr.microsoft.com/powershell:latest

# Disable PowerShell telemetry
ENV POWERSHELL_TELEMETRY_OPTOUT=1

# Copy the extra packages file into the image
COPY extra-packages.txt /tmp/extra-packages.txt

# Install extra packages if the file is not empty
RUN if [ -s /tmp/extra-packages.txt ]; then \
      apt-get update && xargs apt-get install -y < /tmp/extra-packages.txt; \
    fi

# Set the working directory for your scripts
WORKDIR /scripts

# Copy the entrypoint script
COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

ENTRYPOINT ["/entrypoint.sh"]
